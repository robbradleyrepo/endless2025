/*
*   Description: ENDLESS
*   Date: Aug 2019
*   Version 2.0.0
*/

/*eslint-disable */

'use strict';

////////////////////////////////////////////
// DOC READY
////////////////////////////////////////////



$(document).ready(function () {

	/***************************/
	// MASTER INTRO VIDEO OPTION
	/***************************/
	$(".page-wrap").fadeIn(500);
	
	// $('.annoy-trigger').click(function (e) {
	// 	e.preventDefault();
	// 	$('body').addClass('disable');
	// 	$('.annoy-screen').addClass('spin').on("touchmove", false);
		
	// 	$('.annoy-screen').animate({
	// 		right: '0'
	// 	}, 300); 

	// 	setTimeout(function() { 
			
			
	// 		$('.annoy-screen').animate({
	// 			right: '-100%'
	// 		}, 100); 

	// 		$('body').animate({
	// 			top: '0'
	// 		}, 10);
			
	// 	}, 12000);


	// 	setTimeout(function() { 
	// 		$('body').removeClass('disable');
	// 		$('.annoy-screen').removeClass('spin').on("touchmove", true);
	// 		$('.annoy-screen').css("right", "");
	// 	}, 13000);


	// });

	 
 
	// if no touch
	if (!Modernizr.touch) {

		console.log(window.location.pathname);

		function goVideo() {
			
			$('.gateway-screen').animate({
					top: '-101%'
				}, 300);

			if ( $('body').hasClass('sound-on') ) {

				//play robot
				$('.botfx').get(0).play();

				// $('.page-wrap').delay(500).before('<div class=\'video-screen\'></div><div class=\'video-master\'><video autoplay preload=\'metadata\'><source src=\'media/intro_video_v2.mp4\' class=\'video-actual\' type=\'video/mp4\'></video></div>');

				// $('.video-screen').fadeOut(300);

				// $('video').trigger('play');

				// $('video').on('ended', function () {

					$('body').removeClass('disable');

					$('.video-master').animate({
						transform: 'translateY(-100%)' 
					}, 300);

					$(".page-wrap").delay(200).fadeIn(800);

					$(".page-wrap").promise().done(function () { 
						$('.video-master').remove();
					}); 
				// });

			} else {

				 $('body').removeClass('disable');

				$('body').find('audio').attr('muted');
				$('body').find('.indicators').hide(); 
			}

			
			 		
		};

		if (window.location.pathname == '/' || window.location.pathname == '/index.html' ) {
			// ROOT - play video then bring content in
			 

			$('body').addClass('disable');
			$(".gateway-screen").fadeIn(300);
			$('body').removeClass('sound-on');
		

			//$('video').trigger('pause');

			$('.fx').on('click', function (e) {
				e.preventDefault;
				$('body').addClass('sound-on');
				goVideo();	

			});

			$('.nofx').on('click', function (e) {
				e.preventDefault;
				goVideo();
			});
						

		} else {
			// Other page - fade in as normal
			$(".page-wrap").fadeIn(500);
			$('body').removeClass('disable');
		}
	} else {
		$(".gateway-screen").hide();
		$(".page-wrap").fadeIn(500);
		//no touch
		$('body').removeClass('disable');
	}


 
	/******************************************/
	/* Disable right click for save images    */
	/******************************************/

	$('img').bind('contextmenu', function (e) {
		return false;
	});

	/******************************************/
	/* MOBILE menu    */
	/******************************************/

	$('.nav-close').click(function (e) {
		e.preventDefault();
		$('.sliding-panel-content,.sliding-panel-fade-screen').removeClass('is-visible');
		$('body').removeClass('disable');
	});

	$('#mobile-nav .nav-link').click(function (e) {
		//e.preventDefault();
		$('.sliding-panel-content,.sliding-panel-fade-screen').removeClass('is-visible');
		$('body').removeClass('disable');
	});

	$('.js-menu-trigger,.sliding-panel-fade-screen,.sliding-panel-close').on('click touchstart', function (e) {
		//console.log('menu icon clicked');
		$('.sliding-panel-content,.sliding-panel-fade-screen').toggleClass('is-visible');
		$('body').toggleClass('disable');
		e.preventDefault();
	});

	function eventArtwork() {

		
 
	
	 

		$('img').bind('contextmenu', function (e) {
			return false;
		});

		var clickCount = 0;
		clickCount = clickCount == 5 ? 0 : clickCount;

		// GOLD ANIMATION w/ sounds
		$('.gold-trigger').click(function (e) {
			e.preventDefault();
			//$(this).removeClass('gold-active');
			// $('.gold-img').addClass('gold-active');

			if (clickCount == 0) {
				console.log('1st click');
				
				if ( $('body').hasClass('sound-on') ) {
					$('.songs').get(0).play();
				};

				$('.gold-img').addClass('gold-active');

				$('.gold-img').on('webkitAnimationEnd oanimationend msAnimationEnd animationend', function (e) {
					 
					$(this).removeClass('gold-active');
				});

				clickCount++;
			} else if (clickCount == 1) {
				console.log('2nd click');
				if ( $('body').hasClass('sound-on') ) {
					$('.songs').get(1).play();
				}

				$('.gold-img').addClass('gold-active');

				$('.gold-img').on('webkitAnimationEnd oanimationend msAnimationEnd animationend', function (e) {
					 
					$(this).removeClass('gold-active');
				});

				clickCount++;
			} else if (clickCount == 2) {
				
				if ( $('body').hasClass('sound-on') ) {
					$('.songs').get(2).play();
				};

				$('.gold-img').addClass('gold-active');

				$('.gold-img').on('webkitAnimationEnd oanimationend msAnimationEnd animationend', function (e) {
					 
					$(this).removeClass('gold-active');
				});

				clickCount++;
			} else if (clickCount == 3) { 
				if ( $('body').hasClass('sound-on') ) {
					$('.songs').get(3).play();
				};

				$('.gold-img').addClass('gold-active');

				$('.gold-img').on('webkitAnimationEnd oanimationend msAnimationEnd animationend', function (e) {
				 
					$(this).removeClass('gold-active');
				});

				clickCount++;
			} else if (clickCount == 4) {
				console.log('5th click');
				if ( $('body').hasClass('sound-on') ) {
					$('.songs').get(4).play();
				};

				$('.gold-img').addClass('gold-active');

				$('.gold-img').on('webkitAnimationEnd oanimationend msAnimationEnd animationend', function (e) {
					 
					$(this).removeClass('gold-active');
				});

				clickCount = 0;
			}
		});

		$('.print-button').click(function (e) {
			e.preventDefault();
			$(this).toggleClass('active');
			$(this).siblings('.artwork-copy').toggleClass('inactive');
			$(this).siblings('.print-copy').toggleClass('active');
		});

		// nav selected states
		$("#primary-nav a").removeClass("nav-active");
		if (window.location.href.indexOf("index") > -1) {
			$("#primary-nav a.nav-home").addClass("nav-active");
		}
		if (window.location.href.indexOf("about") > -1) {
			$("#primary-nav a.nav-about").addClass("nav-active");
		} else if (window.location.href.indexOf("artwork") > -1) {
			$("#primary-nav a.nav-artwork").addClass("nav-active");
		} else if (window.location.href.indexOf("exhibitions") > -1) {
			$("#primary-nav a.nav-exhibitions").addClass("nav-active");
		} else if (window.location.href.indexOf("field") > -1) {
			$("#primary-nav a.nav-field").addClass("nav-active");
		} else if (window.location.href.indexOf("press") > -1) {
			$("#primary-nav a.nav-press").addClass("nav-active");
		} else if (window.location.href.indexOf("subscribe") > -1) {
			$("#primary-nav a.nav-subscribe").addClass("nav-active");
		} else if (window.location.href.indexOf("contact") > -1) {
			$("#primary-nav a.nav-contact").addClass("nav-active");
		}
		else if (window.location.href.indexOf("books") > -1) {
			$("#primary-nav a.nav-books").addClass("nav-active");
		}

		$('html, body').animate({
			scrollTop: "0px"
		}, 800);

		$('.back-top').click(function (e) {
			e.preventDefault();
			$('html, body').animate({
				scrollTop: "0px"
			}, 200);
		});

		if (window.location.href.indexOf("exhibitions") > -1) {

			$('.exhibitions-slider').slick({
				dots: true,
				infinite: true,
				speed: 500,
				fade: true, 
				cssEase: 'linear',
				slidesToShow: 1,
			slidesToScroll: 1,
			autoplay: true,
			autoplaySpeed: 2000,
			});
			
		}
	};

	var FadeTransition = Barba.BaseTransition.extend({
		start: function start() {
			Promise.all([this.newContainerLoading, this.fadeOut()]).then(this.fadeIn.bind(this));
		},

		fadeOut: function fadeOut() {
			return $(this.oldContainer).animate({ opacity: 0 }).promise();
		},

		fadeIn: function fadeIn() {

			var _this = this;
			var $el = $(this.newContainer);

			$(this.oldContainer).hide();

			$el.css({
				visibility: 'visible',
				opacity: 0
			});

			$el.animate({ opacity: 1 }, 400, function () {
				_this.done();
			});
		}
	});

	Barba.Pjax.getTransition = function () {
		return FadeTransition;
	};

	Barba.Pjax.start();

	Barba.Dispatcher.on('newPageReady', function (currentStatus, oldStatus, container) {
		return eventArtwork();
	});

	Barba.Dispatcher.on('transitionCompleted', function(currentStatus, oldStatus, container) {
	
	});

	return eventArtwork();

 
});
// end doc ready

$(window).resize(function () {

	if ($(window).width() <= 801) {

		if ( $('body').hasClass('sound-on') ) {
			$(this).removeClass('sound-on');
		};

	}
});

$(window).on("orientationchange", function () {

	// if(window.orientation == 0) // Portrait
	// {
	//   $(".section").css('height',  $.windowHeight("visual")-57+'px' );
	// }

	// else // Landscape
	// {
	//    $(".section").css('height', 'auto' );
	// }

});

$('.nav-dontclick').click(function (e) {
	e.preventDefault();
	
});






//# sourceMappingURL=main.js.map

